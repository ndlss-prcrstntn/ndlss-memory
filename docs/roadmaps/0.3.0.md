# Roadmap 0.3.0

План на `0.3.0` сформирован из:

- незакрытых пунктов roadmap `0.2.0`;
- дополнительного списка требований, которые еще не реализованы в текущем репозитории.

## 0. Zero-Friction Setup (DX-first)

- [ ] Автоматическое создание коллекции в Qdrant при старте стека (без первого ingestion-upsert)
- [ ] Автоматический запуск первичной индексации при первом запуске (one-time bootstrap)
- [ ] Подключение к MCP-клиентам с минимальной ручной настройкой (готовые профили/шаблоны)
- [x] Автоматическая preflight-проверка зависимостей при старте (`qdrant`, `git`, доступность workspace)
- [x] Четкий стартовый статус в CLI/log output: `Index ready`, `chunks`, `MCP endpoint`
- [ ] Режим `INDEX_MODE=watch` (непрерывная индексация изменений)
- [ ] Автоопределение языка/типа проекта и применение подходящего preset
- [ ] Fallback на in-memory режим при недоступности persistent storage/Qdrant
- [ ] Документация "3 минуты до первого запроса" как отдельный быстрый сценарий smoke

## 2. Конфигурация индексатора

- [ ] Лимит глубины обхода директории
- [ ] Лимит количества файлов на запуск

## 4. Пайплайн чанкинга и эмбеддингов

- [ ] Расширенные метаданные чанков:
- [ ] `line_start`
- [ ] `line_end`
- [ ] стабильный `chunk_index` в публичном контракте metadata
- [ ] Symbol metadata:
- [ ] список функций
- [ ] список классов
- [ ] список импортов
- [ ] AST-парсинг (tree-sitter) для поддерживаемых языков
- [ ] Token-aware context packing для более точного retrieval

## 5. Идемпотентность индексации

- [ ] Soft-delete механизм (пометка + последующая уборка)
- [ ] Index journal (аудируемый лог изменений индекса)

## 6. Delta-after-commit

- [ ] MCP tool: `run_delta_index`
- [ ] Semantic diff (AST-based) для уменьшения лишних reindex-операций
- [ ] Опция игнорирования `untracked` файлов
- [ ] Поддержка monorepo-сценариев (несколько корней/пакетов)

## 7. MCP-инструменты

- [ ] Tool: `search_by_symbol`
- [ ] Tool: `get_file_by_path`
- [ ] Tool: `get_project_summary`
- [ ] Tool: `reindex_project`
- [ ] Tool: `run_tests`
- [ ] Tool: `git_diff`
- [ ] Tool: `create_task_plan`
- [ ] Tool: `get_current_plan`
- [ ] Tool: `update_task_status`

## 8. Безопасный запуск команд

- [ ] Явный seccomp-профиль для `mcp-server`
- [ ] Лимит параллельных команд
- [ ] Выделенный sandbox temp directory с контролем квот

## 9. Качество и стабильность

- [ ] Snapshot-тесты индекса
- [ ] Нагрузочный тест (1000+ файлов)
- [ ] Smoke test "3 минуты до первого запроса"
- [ ] Интеграционные/контрактные тесты watch-mode

## 10. Open-source упаковка

- [ ] Архитектурная диаграмма как отдельный артефакт в docs
- [ ] GIF-демо "start -> index -> search"
- [ ] Minimal example repository для быстрого onboarding
- [ ] Раздел Security в документации (threat model, ограничения, best practices)

## Критерии готовности 0.3.0

- [ ] `docker compose up` в "no-clone" сценарии приводит к готовому индексу без ручного запуска ingestion
- [ ] watch-mode покрыт интеграционными тестами
- [ ] новые MCP tools покрыты contract-тестами и примерами запросов в docs
- [ ] опубликован релиз `0.3.0` с обновленным changelog и roadmap snapshot
